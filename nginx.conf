# This is the user Nginx will run as. On Windows, it's typically 'nobody'.
user nobody;

# Defines the number of worker processes. 'auto' is usually a good choice.
worker_processes auto;

# Sets the path for the error log file.
error_log logs/error.log;

# Sets the path for the PID file.
pid logs/nginx.pid;

events {
    # Sets the maximum number of simultaneous connections for each worker process.
    worker_connections 1024;
}

http {
    # Includes common MIME types. This file is usually in the same 'conf' directory.
    include       mime.types;
    default_type  application/octet-stream;

    # Sets the path for the access log file.
    access_log logs/access.log;

    # Specifies the server block for your website.
    server {
        # Nginx will listen on port 80 for incoming HTTP requests.
        listen 80;
        
        # This is the domain name Nginx will respond to.
        server_name localhost;

        # This is the root directory for your website files.
        # Nginx for Windows requires forward slashes and quotes for paths with spaces.
        root "C:/Users/Jacob/jacobz.xyz/AWBB";

        # This is a crucial line. It tells Nginx to look for these files in this order
        # when a directory is requested (e.g., http://localhost/).
        index index.php index.html index.htm;
        
        # This block defines how Nginx should handle requests for the root directory.
        location / {
            # try_files first attempts to serve the requested file ($uri),
            # then the directory ($uri/), and finally returns the index.php file
            # with the original query string. This handles both static files and
            # routes all non-existent requests to your main PHP script.
            try_files $uri $uri/ /index.php?$query_string;
        }

        # This block handles all requests for files ending with .php
        location ~ \.php$ {
            # The root directive must be specified again for the PHP location block.

            # This line forwards the PHP file to the PHP-CGI process.
            # It's configured to listen on a local address and port 9000.
            fastcgi_pass   127.0.0.1:9000;
            
            # fastcgi_index is the default index file for PHP.
            fastcgi_index  index.php;
            
            # fastcgi_param tells PHP-CGI where to find the script to execute.
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            
            # This line includes the standard fastcgi parameters.
            include        fastcgi_params;
        }
    }
}